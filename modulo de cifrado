letrasm = "abcdefghijklmñnopqrstuvwxyz"
LETRASM = letrasm.upper()
letras = letrasm + LETRASM
e = 16383605
d = 747759581


def encbin(msg):
    """Función de encriptación
         en binario"""
    nmsg = ""
    for caracter in msg:
        for letra in letras:
            if caracter == letra:
                binario = (bin(letras.index(caracter)))[2:len(letras)]  # Se halla el valor binario de la letra
                nbin = binario.zfill(6)  # Se rellena el número hallado con ceros para mantener un formato de longitud 6
                nmsg += nbin
        if caracter == " ":  # remplazaremos los espacios en blanco por un guion bajo
            nmsg += "_"
    return nmsg


def dscbin(msg):
    """Función para desencriptar binario
        """
    contador = 0
    nmsg = ""
    while contador < len(msg):  # Ejecuta la función mientras existan letras por descifrar
        binario = msg[contador: contador + 6]
        if binario[0] == "_":
            contador += 1
            binario = msg[contador: contador + 6]
            nmsg += " "  # Se agregan espacios y se saltan en el contador
        for letra in letras:
            binlet = (bin(letras.index(letra)))[2:len(letras)]
            if binario == binlet.zfill(6):  # Se encuentra la letra que cumpla el valor binario según el formato
                nmsg += letra
        contador += 6
    return nmsg


def enccsr(msg, clave):
    """Función de encriptar en cifrado césar
        """
    nmsg = ""
    limit = len(letras)
    contador = 0
    for caracter in msg:
        if caracter == " ":
            nmsg += "_"
        else:
            indCsr = letras.index(caracter) + letras.index(clave[
                                                               contador]) + 1  # Cambia la letra según el valor del indice del contador, se agrega 1 para evitar el 0
            if indCsr == limit:
                indCsr -= limit  # Si el indice es mayor a lo posible se repite
            nmsg += letras[indCsr]
            contador += 1
            if contador == len(clave):
                contador = 0
    return nmsg


def dsccsr(msg, clave):
    """Función de desencripar cifrado césar
    """
    nmsg = ""
    contador = 0
    for caracter in msg:
        if caracter == "_":
            nmsg += " "
        else:
            indCsr = letras.index(caracter) - letras.index(clave[
                                                               contador]) - 1  # Cambia la letra según el valor del indice del contador, se resta 1 para evitar el 0
            nmsg += letras[indCsr]
            contador += 1
            if contador == len(clave):
                contador = 0
    return nmsg


def encasm (msg, llv):
    """Función de encriptación asimetrica
        """
    nmsg = []
    for caracter in msg:
        if caracter == " ":
            nmsg.append(caracter)
        else:
            numcar = letras.index(caracter)
            nnum = (numcar * llv) % 2070449999
            nmsg.append(nnum)
    return nmsg


def dscasm(msg, llv):
    """Función de desencriptación asimetrica
            """
    nmsg = ""
    for elemento in msg:
        if type(elemento) == str:
            nmsg += elemento
        else:
            nnum = (elemento * llv) % 2070449999
            nmsg += "{0}".format(letras[nnum])
    return nmsg

def bininv(bin):
    '''Función para hallar la inversa de binarios '''
    nbin = ""
    carry = "0"
    fbin = ""
    for digito in bin:
        if digito == "1":
            nbin = "0" + nbin
        else:
            nbin = "1" + nbin
    if nbin[0] == "0":
        fbin = "1"
        for posicion in range(len(nbin) - 1):
            fbin = nbin[posicion + 1] + fbin
    else:
        carry = 1
        fbin = "0"
        counter = 1
        while carry == 1:
            if nbin[counter] == "1":
                fbin = "0" + fbin
                if counter == len(nbin) - 1:
                    carry = 0
            else:
                fbin = "1" + fbin
                carry = 0
            counter += 1
        for posicion in range(len(nbin) - counter):
            fbin = nbin[counter] + fbin
    return fbin
